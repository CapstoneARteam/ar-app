(this["webpackJsonpar-app"]=this["webpackJsonpar-app"]||[]).push([[0],{171:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=171},312:function(e,t,n){"use strict";(function(e){var a=n(103),o=n(62),i=n(0),r=n.n(i),l=n(323),c=n(550),s=n(551),u=n(549),d=(n(121),n(19)),m=n(154),p=n(69),h=n(60),f="capstonear_app-xkqng",g=d.d.hasAppClient(f)?d.d.getAppClient(f):d.d.initializeDefaultAppClient(f),b=g.getServiceClient(d.c.factory,"mongodb-atlas").db("APP"),v={},E={position:"fixed",width:"60px",height:"60px",bottom:"40px",right:"40px",backgroundColor:"#0C9",color:"#FFF",borderRadius:"50px",textAlign:"center",boxShadow:"2px 2px 3px #999",zIndex:1500},_=function(e){return console.log("open file"),console.log(e.base64data),r.a.createElement("div",null,r.a.createElement("input",{type:"file",multiple:"single",onChange:function(t){return function(e,t){console.log(t.target.files),console.log(t.target.files[0]);var n=new FileReader;n.readAsDataURL(t.target.files[0]),n.onloadend=function(t){e.setbase64data(n.result),console.log(e)}}(e,t)}}),r.a.createElement("img",{style:{height:"200px",width:"300px"},src:e.base64data}))},y=function(e){var t=Object(i.useState)({title:e.title,description:e.description,hint:e.hint,destination:e.destination}),n=Object(o.a)(t,2),a=n[0],l=n[1];return r.a.createElement(p.a,Object.assign({},e,{centered:!0,show:e.show,style:{zIndex:"1600"}}),r.a.createElement(p.a.Header,null,r.a.createElement(p.a.Title,null,"Edit a Pin")),r.a.createElement(p.a.Body,null,r.a.createElement("label",{className:"d-block",htmlFor:"title"},"Title"),r.a.createElement("input",{type:"text",className:"w-100",id:"title",required:!0,defaultValue:a.title}),r.a.createElement("label",{className:"d-block",htmlFor:"description"},"Description"),r.a.createElement("textarea",{className:"w-100",id:"description",defaultValue:a.description,required:!0}),r.a.createElement("label",{className:"d-block",htmlFor:"hint"},"Hint"),r.a.createElement("textarea",{className:"w-100",id:"hint",defaultValue:a.hint,required:!0}),r.a.createElement("label",{className:"d-block",htmlFor:"destination"},"Destination"),r.a.createElement("textarea",{className:"w-100",id:"destination",defaultValue:a.destination,required:!0}),r.a.createElement("img",{style:{height:"200px",width:"300px"},src:"https://capstoneusercontent.s3-us-west-2.amazonaws.com/"+e.id+".jpeg"})),r.a.createElement(p.a.Footer,null,r.a.createElement("button",{className:"btn btn-secondary",onClick:e.cancel},"Cancel"),r.a.createElement("button",{className:"btn btn-primary",onClick:function(){var t=document.getElementById("title").value||"",n=document.getElementById("hint").value||"",a=document.getElementById("description").value||"",o=document.getElementById("destination").value||"",i={_id:e.objectID},r={$set:{title:t,description:a,hint:n,destination:o}};b.collection("PINS").findOneAndUpdate(i,r).then((function(i){l({title:t,description:a,hint:n,destination:o}),e.cancel()}))}},"Submit")))},w=function(e){var t=Object(i.useState)(!1),n=Object(o.a)(t,2),a=n[0],c=n[1];return r.a.createElement(l.a,{key:v,position:[e.lat,e.lng],onClick:function(){c(!a)}},r.a.createElement(y,{id:e.id,description:e.description,hint:e.hint,destination:e.destination,title:e.title,objectID:e.objectID,lng:e.lng,lat:e.lat,show:a,cancel:function(){return c(!1)}}))},x=function(t){return r.a.createElement(p.a,Object.assign({},t,{centered:!0,style:{zIndex:"1600"}}),r.a.createElement(p.a.Header,null,r.a.createElement(p.a.Title,null,"Add a Pin")),r.a.createElement(p.a.Body,null,r.a.createElement("label",{className:"d-block",htmlFor:"title"},"Title"),r.a.createElement("input",{type:"text",className:"w-100",id:"title",required:!0}),r.a.createElement("label",{className:"d-block",htmlFor:"description"},"Description"),r.a.createElement("textarea",{className:"w-100",id:"description",required:!0}),r.a.createElement("label",{className:"d-block",htmlFor:"hint"},"Hint"),r.a.createElement("textarea",{className:"w-100",id:"hint",required:!0}),r.a.createElement("label",{className:"d-block",htmlFor:"destination"},"Destination"),r.a.createElement("textarea",{className:"w-100",id:"destination",required:!0}),r.a.createElement("label",{className:"d-block",htmlFor:"pinImage"},"Image"),r.a.createElement(_,{base64data:t.base64data,setbase64data:t.setbase64data})),r.a.createElement(p.a.Footer,null,r.a.createElement("button",{className:"btn btn-secondary",onClick:t.onHide},"Cancel"),r.a.createElement("button",{className:"btn btn-primary",onClick:function(){var n=document.getElementById("title").value||"",o=document.getElementById("hint").value||"",i=document.getElementById("description").value||"",l=document.getElementById("destination").value||"",c=v,s=c.lng,u=c.lat;b.collection("PINS").insertOne({title:n,owner_id:g.auth.authInfo.userId,description:i,hint:o,destination:l,audio:"",video:"",coords:[u,s]}).then((function(c){!function(t,n){console.log(t),console.log(n);var a=t.replace(/^data:image\/\w+;base64,/,""),o=new e(a,"base64"),i=new d.a.Binary(new Uint8Array(o),0),r=g.getServiceClient(m.b.factory,"capstoneusercontent"),l={ACL:"public-read",Bucket:"capstoneusercontent",ContentType:"image/jpeg",Key:n+".jpeg",ContentEncoding:"base64",Body:i},c=(new m.a.Builder).withService("s3").withAction("PutObject").withRegion("us-west-2").withArgs(l);console.log(c),r.execute(c.build()).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}(t.base64data,c.insertedId.toString()),t.setMarkers([].concat(Object(a.a)(t.markers),[r.a.createElement(w,{id:c.insertedId.toString(),description:i,hint:o,destination:l,title:n,objectID:c.insertedId,lng:s,lat:u})]));var p=t.module;p.pins=[].concat(Object(a.a)(p.pins),[c.insertedId]),t.setModule(p);var h={_id:p._id},f={$set:{pins:p.pins}};b.collection("MODULES").findOneAndUpdate(h,f,{upsert:!1}).then((function(e){})).catch(console.error)})),t.onHide()}},"Submit")))};t.a=function(e){var t=Object(i.useState)([45,45]),n=Object(o.a)(t,2),a=n[0],d=n[1],m=Object(i.useState)([]),p=Object(o.a)(m,2),f=p[0],g=p[1],_=Object(i.useState)(!1),y=Object(o.a)(_,2),O=y[0],k=y[1],j=Object(i.useState)(!1),C=Object(o.a)(j,2),S=C[0],I=C[1],D=Object(i.useState)("default 64"),A=Object(o.a)(D,2),P=A[0],L=A[1],M=Object(i.useState)({_id:"",title:"",owner_email:"",owner_id:"",owner_name:"",description:"",pins:[],shared_array:[],public:!1}),N=Object(o.a)(M,2),U=N[0],z=N[1];return Object(i.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(e){var t=e.coords,n=t.latitude,a=t.longitude;d([n,a])}))}),[]),Object(i.useEffect)((function(){var t={_id:Object(h.ObjectId)(e.match.params.id)};b.collection("MODULES").findOne(t).then((function(e){z(e);var t=[{$match:{_id:{$in:e.pins}}},{$addFields:{__order:{$indexOfArray:[e.pins,"$_id"]}}},{$sort:{__order:1}}];b.collection("PINS").aggregate(t).toArray().then((function(e){g(e.map((function(e){return r.a.createElement(w,{id:e._id.toString(),description:e.description,hint:e.hint,destination:e.destination,title:e.title,objectID:e._id,lng:e.coords[1],lat:e.coords[0]})})))}))})).catch(console.error)}),[e.match.params.id]),r.a.createElement(c.a,{center:a,zoom:13,onClick:function(e){O&&(v=e.latlng,I(!0),k(!O))}},r.a.createElement(x,{show:S,onHide:function(){return I(!1)},setMarkers:g,markers:f,setModule:z,module:U,setbase64data:L,base64data:P}),r.a.createElement("button",{style:{zIndex:1500,position:"fixed",bottom:"10px",left:"10px",textAlign:"center"},className:"btn btn-primary",onClick:function(){window.history.back()}},"Save"),r.a.createElement("button",{style:E,onClick:function(){return k(!O)}},r.a.createElement("div",{style:{fontSize:"40px"}},"+")),r.a.createElement(s.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),r.a.createElement(l.a,{position:a},r.a.createElement(u.a,null,"Your location")),f)}}).call(this,n(20).Buffer)},324:function(e,t,n){e.exports=n(548)},329:function(e,t,n){},330:function(e,t,n){},345:function(e,t){},347:function(e,t){},357:function(e,t){},359:function(e,t){},385:function(e,t){},387:function(e,t){},388:function(e,t){},394:function(e,t){},396:function(e,t){},414:function(e,t){},417:function(e,t){},433:function(e,t){},436:function(e,t){},476:function(e,t){},478:function(e,t){},533:function(e,t,n){},537:function(e,t,n){},548:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(46),r=n.n(i),l=(n(329),n(37)),c=n(38),s=n(22),u=n(40),d=n(39),m=(n(330),n(331),n(323)),p=n(549),h=n(550),f=n(551),g=(n(121),n(29)),b=n.n(g);delete b.a.Icon.Default.prototype._getIconUrl,b.a.Icon.Default.mergeOptions({iconRetinaUrl:n(208),iconUrl:n(209),shadowUrl:n(210)});var v=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={currentLocation:{lat:45.51,lng:-122.68},zoom:13,userLocation:[],userLocationFound:!1},a.getUserPosition=a.getUserPosition.bind(Object(s.a)(a)),a}return Object(c.a)(n,[{key:"getUserPosition",value:function(){var e=this;navigator.geolocation.getCurrentPosition((function(t){e.setState({userLocation:[t.coords.latitude,t.coords.longitude],userLocationFound:!0,currentLocation:[t.coords.latitude,t.coords.longitude]}),console.log(e.state)}))}},{key:"componentDidMount",value:function(){this.getUserPosition()}},{key:"render",value:function(){var e=this.state.userLocationFound?o.a.createElement(m.a,{position:this.state.userLocation},o.a.createElement(p.a,null,"Your location")):null;return o.a.createElement("div",{id:"leaflet-container"},o.a.createElement(h.a,{center:this.state.currentLocation,zoom:13,maxZoom:18},o.a.createElement(f.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),e))}}]),n}(a.Component),E=n(142),_=n(30),y=n.n(_),w=n(45),x=n(19),O=n(60),k=n(144);function j(){var e=Object(E.a)(["\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    background: #343a40;\n    transform: ",";\n    height: 100vh;\n    text-align: left;\n    padding: 2rem;\n    position: fixed;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    transition: transform 0.3s ease-in-out;\n    z-index: 1501;\n\n    @media (max-width: 150px) {\n        width: 100%;\n    }\n\n    a {\n        font-size: 1.5rem;\n        text-transform: uppercase;\n        padding: 2rem 0;\n        font-weight: Light;\n        letter-spacing: 0.5rem;\n        color: #FFFFF;\n        text-decoration: none;\n        transition: color 0.3s linear;\n\n        @media (max-width: 150px) {\n            font-size: 1rem;\n            text-align: center;\n        }\n\n        &:hover {\n            color: #343078;\n        }\n    }\n"]);return j=function(){return e},e}var C=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;Object(l.a)(this,n),(a=t.call(this,e)).state={username:"",useremail:"",userID:"",stitch_res:[],menuOpen:a.props.open},a.login=a.login.bind(Object(s.a)(a)),a.logout=a.logout.bind(Object(s.a)(a)),a.addamodule=a.addamodule.bind(Object(s.a)(a)),a.listmymodules=a.listmymodules.bind(Object(s.a)(a)),console.log(e);var o="capstonear_app-xkqng";if(x.d.hasAppClient(o)){a.client=x.d.getAppClient(o);var i=a.client.getServiceClient(x.c.factory,"mongodb-atlas");a.db=i.db("APP")}return a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=Object(w.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.client.auth.isLoggedIn&&this.client.auth.authInfo.userProfile&&(this.setState({username:this.client.auth.authInfo.userProfile.data.first_name,useremail:this.client.auth.authInfo.userProfile.data.email,userID:this.client.auth.authInfo.userId,userImg:this.client.auth.authInfo.userProfile.data.picture}),console.log(this.client.auth.authInfo.userProfile.data));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(w.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new x.b,this.client.auth.loginWithRedirect(t),console.log(this.state);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(w.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.auth.logout();case 2:this.setState({username:"",useremail:"",userID:""}),window.location.reload();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addamodule",value:function(){this.db.collection("MODULES").insertOne({owner_id:this.state.userID,name:this.state.temp_module_name,owner:this.state.useremail}).catch(console.error)}},{key:"listmymodules",value:function(){var e=this;this.client.auth.isLoggedIn&&this.db.collection("PINS").find({_id:Object(O.ObjectId)("5ebed1bc5992681f357d7948")}).asArray().then((function(t){e.setState({stitch_res:t}),console.log(e.state.stitch_res[0])}))}},{key:"render",value:function(){var e=this;return o.a.createElement(S,{open:this.props.open,setOpen:this.props.setOpen,center_container:this.props.center_container,style:{}},o.a.createElement("div",{style:{position:"absolute",top:"2rem"}},o.a.createElement("img",{src:this.state.userImg,alt:"test",style:{maxHeigh:"80px",maxWidth:"80px",borderRadius:"50%",top:"1rem"}}),o.a.createElement("p",{style:{fontSize:"1.5rem",top:"4rem",color:"white",zIndex:1002}}," ","Welcome, ",o.a.createElement("br",null)," ",this.state.username," ")),o.a.createElement("ul",{style:{listStyleType:"none",paddingLeft:0},onClick:function(){e.props.center_container.center_container.current.style.opacity=1,e.props.setOpen(!e.props.open)}},o.a.createElement("li",null,o.a.createElement("a",{href:"#/"},"Home")),o.a.createElement("br",null),o.a.createElement("li",null,o.a.createElement("a",{href:"#/modules"},"My Modules")),o.a.createElement("br",null),o.a.createElement("li",null,o.a.createElement("a",{href:"#/modules/edit"},"Manage Modules")),o.a.createElement("br",null)),o.a.createElement("a",{href:"#/logout",onClick:this.logout,style:{position:"absolute",fontSize:"1rem",fontColor:"#00000",bottom:"10rem"}},"Log Out"))}}]),n}(a.Component),S=k.a.nav(j(),(function(e){return e.open?"translateX(-100)":"translateX(100%)"})),I=C,D=(n(533),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(l.a)(this,n);return(e=t.call(this)).client=x.d.getAppClient("capstonear_app-xkqng"),e.login=e.login.bind(Object(s.a)(e)),e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.client.auth.hasRedirectResult()&&(console.log("has results"),this.client.auth.handleRedirectResult().then((function(t){e.setState({username:e.client.auth.authInfo.userProfile.data.name,useremail:e.client.auth.authInfo.userProfile.data.email,userID:e.client.auth.authInfo.userId}),window.location.assign("#/")})))}},{key:"login",value:function(){var e=Object(w.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new x.b,e.next=3,this.client.auth.loginWithRedirect(t);case 3:console.log(this.state);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return o.a.createElement("div",{class:"row justify-content-center",style:{position:"fixed",margin:"auto",left:0,right:0,top:0,bottom:0,height:"50px"}},o.a.createElement("button",{class:"btn btn-primary",onClick:this.login},"Login with Google"))}}]),n}(a.Component)),A=n(312),P=n(62);function L(){var e=Object(E.a)(["\n  position: fixed;\n  top: 10px;\n  right: 2rem;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-around;\n  width: 2rem;\n  height: 2rem;\n  background: transparent;\n  border: none;\n  cursor: pointer;\n  padding: 0;\n  z-index: 1502;\n\n  &:focus {\n    outline: none;\n  }\n\n  div {\n    width: 2rem;\n    height: 0.25rem;\n    background: ",";\n    border-radius: 10px;\n    transition: all 0.3s linear;\n    position: relative;\n    transform-origin: 1px;\n\n    :first-child {\n      transform: ",";\n    }\n\n    :nth-child(2) {\n      opacity: ",";\n      transform: ",";\n    }\n\n    :nth-child(3) {\n      transform: ",";\n    }\n  }\n"]);return L=function(){return e},e}var M=k.a.button(L(),(function(e){e.open;return"#FFFFFF"}),(function(e){return e.open?"rotate(45deg)":"rotate(0)"}),(function(e){return e.open?"0":"1"}),(function(e){return e.open?"translateX(20px)":"translateX(0)"}),(function(e){return e.open?"rotate(-45deg)":"rotate(0)"})),N=function(e){var t=e.open,n=e.setOpen,a=e.center_container;return console.log(a.center_container.current),o.a.createElement(M,{open:t,onClick:function(){n(!t),a.center_container.current.style.opacity=t?1:.5}},o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null))},U=function(e){var t=o.a.useState(!1),n=Object(P.a)(t,2),a=n[0],i=n[1];return o.a.createElement("div",null,o.a.createElement(N,{open:a,setOpen:i,center_container:e}),o.a.createElement(I,{open:a,setOpen:i,center_container:e}))},z=n(554),F=(n(154),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;Object(l.a)(this,n),(a=t.call(this,e)).fileToBase64=function(e,t){return new Promise((function(n){var a=new File([e],t),o=new FileReader;o.onload=function(e){n(e.target.result)},o.readAsDataURL(a)}))},a.state={current_position:[],module_info:{name:"",owner_email:"",owner_id:"",owner_name:"",description:""},base64img:""},a.getUserPosition=a.getUserPosition.bind(Object(s.a)(a)),a.fetch_userinfo=a.fetch_userinfo.bind(Object(s.a)(a));var o="capstonear_app-xkqng";if(x.d.hasAppClient(o)){a.client=x.d.getAppClient(o);var i=a.client.getServiceClient(x.c.factory,"mongodb-atlas");a.db=i.db("APP"),console.log("client")}else a.client=x.d.initializeAppClient(o),console.log("client init");return a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.getUserPosition(),this.fetch_userinfo();var e="capstonear_app-xkqng";if(x.d.hasAppClient(e)){this.client=x.d.getAppClient(e);var t=this.client.getServiceClient(x.c.factory,"mongodb-atlas");this.db=t.db("APP"),console.log("client")}else this.client=x.d.initializeAppClient(e),console.log("client init")}},{key:"fetch_userinfo",value:function(){var e=Object(w.a)(y.a.mark((function e(){var t=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.db.collection("MODULES").find({_id:Object(O.ObjectId)(this.props.match.params.id)}).asArray().then((function(e){void 0!==e&&0!==e.length?(t.setState({module_info:e[0]}),console.log(e)):console.log(e)})).catch((function(e){t.setState({error:e}),console.log(e)}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserPosition",value:function(){var e=this;navigator.geolocation.getCurrentPosition((function(t){e.setState({userLocation:[t.coords.latitude,t.coords.longitude],userLocationFound:!0,currentLocation:[t.coords.latitude,t.coords.longitude]}),console.log(e.state)}))}},{key:"renderMap",value:function(){var e=this.state.userLocationFound?o.a.createElement(m.a,{position:this.state.userLocation},o.a.createElement(p.a,null,"Your location")):null;return o.a.createElement("div",{id:"leaflet-container"},o.a.createElement(h.a,{center:this.state.currentLocation,zoom:13,maxZoom:18},o.a.createElement(f.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),e))}},{key:"render",value:function(){var e=this;return o.a.createElement(z.a,null,"title:",o.a.createElement("br",null),this.state.module_info.title,o.a.createElement("br",null),o.a.createElement("br",null),"owner_email:",o.a.createElement("br",null),this.state.module_info.owner_email,o.a.createElement("br",null),o.a.createElement("br",null),"owner_name:",o.a.createElement("br",null),this.state.module_info.owner_name,o.a.createElement("br",null),o.a.createElement("br",null),"owner_id:",o.a.createElement("br",null),this.state.module_info.owner_id,o.a.createElement("br",null),o.a.createElement("br",null),"description:",o.a.createElement("br",null),this.state.module_info.description,o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("button",{className:"btn btn-primary",onClick:function(){return window.location.assign("#/module/"+e.state.module_info._id+"/pins")}},"start module"))}}]),n}(a.Component)),R=n(69),B=n(555),$=n(568),q=n(556),T=n(317),H=n(569),G=n(557),K=n(203),W=(n(537),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;Object(l.a)(this,n),(a=t.call(this,e)).state={module_info:{_id:"",title:"",owner_email:"",owner_id:"",owner_name:"",description:"",pins:[],shared_array:[],public:!1},pins:[],modal:!1,idx:-1},a.fetch_userinfo=a.fetch_userinfo.bind(Object(s.a)(a)),a.show_modal=a.show_modal.bind(Object(s.a)(a)),a.hide_modal=a.hide_modal.bind(Object(s.a)(a)),a.modal_component=a.modal_component.bind(Object(s.a)(a)),a.delete_pin=a.delete_pin.bind(Object(s.a)(a)),a.list_pins=a.list_pins.bind(Object(s.a)(a)),a.module_form=a.module_form.bind(Object(s.a)(a)),a.save_pin_order=a.save_pin_order.bind(Object(s.a)(a)),a.save_module=a.save_module.bind(Object(s.a)(a));var o="capstonear_app-xkqng";a.client=x.d.hasAppClient(o)?x.d.getAppClient(o):x.d.initializeDefaultAppClient(o);var i=a.client.getServiceClient(x.c.factory,"mongodb-atlas");return a.db=i.db("APP"),a.fetch_userinfo(),a}return Object(c.a)(n,[{key:"fetch_userinfo",value:function(){var e=Object(w.a)(y.a.mark((function e(){var t,n=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={_id:Object(O.ObjectId)(this.props.match.params.id)},e.next=3,this.db.collection("MODULES").findOne(t).then((function(e){console.log("Module: ",e),n.setState({module_info:e});var t=[{$match:{_id:{$in:e.pins}}},{$addFields:{__order:{$indexOfArray:[e.pins,"$_id"]}}},{$sort:{__order:1}}];n.db.collection("PINS").aggregate(t).toArray().then((function(e){console.log("Pins: ",e),n.setState({pins:e})}))})).catch(console.error);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"show_modal",value:function(){this.setState({modal:!0})}},{key:"hide_modal",value:function(){this.setState({modal:!1})}},{key:"modal_component",value:function(){var e,t=this;return e=this.state.idx<0?o.a.createElement("p",null,"Nothing to delete"):o.a.createElement("p",null,"Are you sure you want to delete"," ",o.a.createElement("b",null,this.state.pins[this.state.idx].title),"?"),o.a.createElement(R.a,{show:this.state.modal,onHide:function(e){e.preventDefault(),t.hide_modal()},style:{marginTop:"50px"}},o.a.createElement(R.a.Header,{closeButton:!0},o.a.createElement(R.a.Title,null,"Confirm Deletion")),o.a.createElement(R.a.Body,null,e),o.a.createElement(R.a.Footer,null,o.a.createElement(B.a,{variant:"danger",onClick:function(e){e.preventDefault(),t.state.idx>-1&&t.delete_pin(t.state.idx),t.hide_modal()}},"Delete")," ",o.a.createElement(B.a,{variant:"secondary",onClick:function(e){e.preventDefault(),t.hide_modal()}},"Cancel")))}},{key:"module_form",value:function(){var e=this;return o.a.createElement($.a,null,o.a.createElement($.a.Group,null,o.a.createElement($.a.Label,null,"Title"),o.a.createElement($.a.Control,{type:"title",id:"title",value:this.state.module_info.title,onChange:function(t){var n=e.state.module_info;n.title=t.target.value,e.setState({module_info:n})}})),o.a.createElement($.a.Group,null,o.a.createElement($.a.Label,null,"Description"),o.a.createElement($.a.Control,{as:"textarea",rows:"5",id:"description",value:this.state.module_info.description,onChange:function(t){var n=e.state.module_info;n.description=t.target.value,e.setState({module_info:n})}})),o.a.createElement($.a.Group,{style:{display:"flex",justifyContent:"center",marginBottom:"0"}},o.a.createElement($.a.Check,{inline:!0,type:"radio",label:"Public",name:"formHorizontalRadios",id:"true",checked:this.state.module_info.public,onChange:function(t){var n=e.state.module_info;n.public=!0,e.setState({module_info:n})}}),o.a.createElement($.a.Check,{inline:!0,type:"radio",label:"Private",name:"formHorizontalRadios",id:"false",checked:!this.state.module_info.public,onChange:function(t){var n=e.state.module_info;n.public=!1,e.setState({module_info:n})}})))}},{key:"list_pins",value:function(){var e=this;return o.a.createElement(K.List,{values:this.state.pins,onChange:function(t){var n=t.oldIndex,a=t.newIndex,o=e.state.pins;o=Object(K.arrayMove)(o,n,a),e.setState({pins:o})},renderList:function(e){var t=e.children,n=e.props;return o.a.createElement("ol",Object.assign({},n,{style:{display:"grid",justifyContent:"center",paddingLeft:"0px"}}),t)},renderItem:function(t){var n=t.index,a=t.props;return o.a.createElement("li",a,o.a.createElement(q.a,{style:{marginTop:"5px",marginBottom:"5px"}},o.a.createElement(T.a,{xs:"4",style:{marginTop:"auto",marginBottom:"auto"}},e.state.pins[n].title),o.a.createElement(T.a,null,o.a.createElement(B.a,{variant:"link",onClick:function(e){e.preventDefault()}},"Edit")),o.a.createElement(T.a,null,o.a.createElement(B.a,{variant:"danger",onClick:function(t){t.preventDefault(),e.setState({idx:n}),e.show_modal()}},"Delete"))))}})}},{key:"delete_pin",value:function(e){var t=this,n={_id:this.state.pins[e]._id};this.db.collection("PINS").deleteOne(n).then((function(n){console.log("Delete response: ",n);var a=t.state.pins;a.splice(e,1),t.setState({pins:a,idx:-1})})).catch(console.error)}},{key:"save_pin_order",value:function(){var e=this.state.module_info,t=this.state.pins.map((function(e){return e._id}));e.pins=t,this.setState({module_info:e})}},{key:"save_module",value:function(){this.save_pin_order();var e={_id:this.state.module_info._id},t={$set:this.state.module_info};this.db.collection("MODULES").updateOne(e,t,{upsert:!1}).then((function(e){console.log("Save response: ",e),window.location.assign("#/modules/edit/")})).catch(console.error)}},{key:"render",value:function(){var e=this;return o.a.createElement(z.a,{style:{marginTop:"10px",maxWidth:"540px",height:"100%"}},o.a.createElement($.a,{style:{height:"100%"}},o.a.createElement(H.a,{defaultActiveKey:"Module Info",transition:!1,style:{textAlign:"center",justifyContent:"center"}},o.a.createElement(G.a,{eventKey:"Module Info",title:"Module Info"},this.module_form()),o.a.createElement(G.a,{eventKey:"Pins",title:"Pins",style:{height:"100%"}},this.list_pins())),o.a.createElement($.a.Group,null,o.a.createElement(B.a,{variant:"primary",size:"lg",block:!0,onClick:function(t){t.preventDefault();var n=e.state.module_info._id;window.location.assign("#/module/"+n+"/pins/edit")}},"Pin Map"),o.a.createElement(B.a,{variant:"secondary",size:"lg",block:!0,onClick:function(t){t.preventDefault(),e.save_module()}},"Save")),o.a.createElement($.a.Group,{style:{display:"flex",justifyContent:"center"}},o.a.createElement(B.a,{variant:"primary"},"Share"))),this.modal_component())}}]),n}(a.Component)),Y=n(570),V=n(573),X=n(558),Z=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;Object(l.a)(this,n),(a=t.call(this,e)).state={modules:[],my_modules:[],shared_modules:[],img1:"",stitch_res:[]},a.goto_module_id=o.a.createRef(),a.add_module_cards=a.add_module_cards.bind(Object(s.a)(a)),a.fetch_modules=a.fetch_modules.bind(Object(s.a)(a)),a.goto_module=a.goto_module.bind(Object(s.a)(a));var i="capstonear_app-xkqng";if(x.d.hasAppClient(i)){a.client=x.d.getAppClient(i);var r=a.client.getServiceClient(x.c.factory,"mongodb-atlas");a.db=r.db("APP")}else a.client=x.d.initializeAppClient(i);return a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.fetch_modules(),console.log(this.state)}},{key:"fetch_modules",value:function(){var e=Object(w.a)(y.a.mark((function e(){var t=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.db.collection("MODULES").find({owner_id:this.client.auth.authInfo.userId}).asArray().then((function(e){t.setState({my_modules:e,modules:{0:e,1:t.state.shared_modules}}),console.log(t.state.my_modules)}));case 2:return e.next=4,this.db.collection("MODULES").find({shared_with:this.client.auth.authInfo.userProfile.data.email}).asArray().then((function(e){t.setState({shared_modules:e,modules:{0:t.state.my_modules,1:e}}),console.log(e)}));case 4:console.log(this.state.modules);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"goto_module",value:function(e){window.location.assign("#/module/"+e)}},{key:"add_module_cards",value:function(e){if(0!==this.state.modules.length){var t=this.state.modules[e].map((function(e,t){return o.a.createElement("div",{className:"col-md-6 col-lg-4 ",key:t},o.a.createElement(V.a,{className:"h-100",style:{display:"fixed",Width:"25rem",margin:"0.25rem",justifyContent:"center",textAlign:"center"}},o.a.createElement(V.a.Body,null,o.a.createElement(V.a.Img,{variant:"top",src:"https://capstoneusercontent.s3.amazonaws.com/ar.png"}),o.a.createElement(V.a.Title,null,e.title),o.a.createElement(V.a.Subtitle,{className:"mb-2 text-muted"},"by ",e.owner_name," (",e.owner_email,")"),o.a.createElement(V.a.Text,null,e.description),o.a.createElement("div",{className:"btn-toolbar",style:{justifyContent:"center"}},o.a.createElement("div",{className:"btn-group mr-1"},o.a.createElement("button",{className:"btn btn-primary",onClick:function(){return window.location.assign("#/module/"+e._id)}},"View Details")),o.a.createElement("div",{className:"btn-group mr-1"},o.a.createElement("button",{className:"btn btn-primary",onClick:function(){return window.location.assign("#/module/"+e._id+"/pins")}},"Start Module"))))))}));return o.a.createElement("div",{style:{top:"50px",bottom:"0px",position:"relative"},className:"container"},o.a.createElement(X.a,{style:{top:"50px"}},t))}}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:{position:"absolute",top:"0px",bottom:"0px",width:"100%",overflowY:"scroll"}},o.a.createElement("div",{style:{top:"10px",bottom:"0px",position:"relative",height:"100vh",marginLeft:"auto",marginRight:"auto"}},o.a.createElement(H.a,{defaultActiveKey:"My Modules",transition:!1,style:{textAlign:"center",justifyContent:"center"}},o.a.createElement(G.a,{eventKey:"My Modules",title:"My Modules"},this.add_module_cards(0)),o.a.createElement(G.a,{eventKey:"Shared Modules",title:"Shared with me"},this.add_module_cards(1)),o.a.createElement(G.a,{eventKey:"Go To",title:"Go To"},o.a.createElement($.a,null,o.a.createElement($.a.Group,{controlId:"formModuleId"},o.a.createElement($.a.Label,null,"Module ID:"),o.a.createElement($.a.Control,{required:!0,type:"string",placeholder:"Enter module id",ref:this.goto_module_id})),o.a.createElement(B.a,{variant:"primary",onClick:function(){window.location.assign("#/module/"+e.goto_module_id.current.value)}},"View Module"))))))}}]),n}(a.Component),J=n(103),Q=n(559),ee=n(560),te=n(561),ne=n(562),ae=n(563),oe=n(564),ie=n(571),re=n(565),le=n(566),ce=n(567),se=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;Object(l.a)(this,n),(a=t.call(this,e)).state={modules:[],modal:!1,idx:-1},a.fetch_userinfo=a.fetch_userinfo.bind(Object(s.a)(a)),a.toggle=a.toggle.bind(Object(s.a)(a)),a.modal_message=a.modal_message.bind(Object(s.a)(a)),a.list_modules=a.list_modules.bind(Object(s.a)(a)),a.delete_module=a.delete_module.bind(Object(s.a)(a)),a.add_module=a.add_module.bind(Object(s.a)(a)),a.save_modules=a.save_modules.bind(Object(s.a)(a));var o="capstonear_app-xkqng";a.client=x.d.hasAppClient(o)?x.d.getAppClient(o):x.d.initializeDefaultAppClient(o);var i=a.client.getServiceClient(x.c.factory,"mongodb-atlas");return a.db=i.db("APP"),a.fetch_userinfo(),a}return Object(c.a)(n,[{key:"fetch_userinfo",value:function(){var e=Object(w.a)(y.a.mark((function e(){var t,n=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={owner_id:this.client.auth.authInfo.userId},e.next=3,this.db.collection("MODULES").find(t).toArray().then((function(e){console.log("Modules loaded: ",e),n.setState({modules:e})})).catch(console.error);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggle",value:function(){var e=!this.state.modal;this.setState({modal:e})}},{key:"modal_message",value:function(){return this.state.idx<0?o.a.createElement("p",null,"Nothing to delete"):o.a.createElement("p",null,"Are you sure you want to delete"," ",o.a.createElement("b",null,this.state.modules[this.state.idx].title),"?")}},{key:"list_modules",value:function(){var e=this;return this.state.modules.map((function(t,n){return o.a.createElement("div",{key:n},o.a.createElement(Q.a,{form:!0},o.a.createElement(ee.a,{xs:"6"},o.a.createElement(te.a,null,o.a.createElement(ne.a,{type:"text",value:e.state.modules[n].title,onChange:function(t){t.preventDefault();var a=Object(J.a)(e.state.modules);a[n].title=t.target.value,e.setState({modules:a})}}))),o.a.createElement(ee.a,null,o.a.createElement(ae.a,{color:"link",onClick:function(t){t.preventDefault();var a=e.state.modules[n]._id;window.location.assign("#/module/"+a+"/edit")}},"Edit")),o.a.createElement(ee.a,null,o.a.createElement(ae.a,{color:"danger",onClick:function(t){t.preventDefault(),e.setState({idx:n}),e.toggle()}},"Delete"))))}))}},{key:"delete_module",value:function(e){var t=this,n={_id:this.state.modules[e]._id};this.db.collection("MODULES").deleteOne(n).then((function(n){console.log("Delete response: ",n);var a=Object(J.a)(t.state.modules);a.splice(e,1),t.setState({modules:a,idx:-1})})).catch(console.error)}},{key:"add_module",value:function(){var e={title:"title",owner_id:this.client.auth.authInfo.userId,owner_name:this.client.auth.authInfo.userProfile.name,owner_email:this.client.auth.authInfo.userProfile.email,description:"",pins:[],shared_with:[],public:!1};this.db.collection("MODULES").insertOne(e).then((function(e){console.log("Add response: ",e);var t=e.insertedId;window.location.assign("#/module/"+t+"/edit")})).catch(console.error)}},{key:"save_modules",value:function(){var e=this;Promise.all(this.state.modules.map((function(t){var n={_id:t._id},a={$set:{title:t.title}};return e.db.collection("MODULES").updateOne(n,a,{upsert:!1})}))).then((function(e){console.log("Save response: ",e)})).catch(console.error)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:{top:"10px",position:"relative",marginLeft:"auto",marginRight:"auto",height:"100%",overflow:"hidden",display:"flex",justifyContent:"center"},className:"container"},o.a.createElement("div",{style:{height:"100%",overflow:"hidden"}},o.a.createElement(oe.a,{style:{height:"100%"},onSubmit:function(t){t.preventDefault(),e.save_modules()}},o.a.createElement("div",{style:{maxHeight:"60%",overflowY:"scroll",overflowX:"hidden"}},this.list_modules()),o.a.createElement("div",{style:{marginTop:"10px"}},o.a.createElement(ae.a,{color:"primary",size:"lg",block:!0,onClick:function(t){t.preventDefault(),e.add_module()}},"Add Module"),o.a.createElement(ae.a,{color:"secondary",size:"lg",block:!0,onClick:function(t){t.preventDefault(),e.save_modules(),window.location.assign("#/")}},"Save"))),o.a.createElement(ie.a,{isOpen:this.state.modal,toggle:function(t){t.preventDefault(),e.toggle()},style:{marginTop:"50px"}},o.a.createElement(re.a,{toggle:function(t){t.preventDefault(),e.toggle()}},"Confirm Deletion"),o.a.createElement(le.a,null,this.modal_message()),o.a.createElement(ce.a,null,o.a.createElement(ae.a,{color:"danger",onClick:function(t){t.preventDefault(),e.state.idx>-1&&e.delete_module(e.state.idx),e.toggle()}},"Delete")," ",o.a.createElement(ae.a,{color:"secondary",onClick:function(t){t.preventDefault(),e.toggle()}},"Cancel")))))}}]),n}(a.Component),ue=n(572);delete b.a.Icon.Default.prototype._getIconUrl,b.a.Icon.Default.mergeOptions({iconRetinaUrl:n(208),iconUrl:n(209),shadowUrl:n(210)});new b.a.Icon({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});var de=new b.a.divIcon({className:"my-div-icon",html:'<span  class="my-div-span">YOU ARE HERE </span><img class="my-div-image" src="https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png"/>'}),me=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;Object(l.a)(this,n),(a=t.call(this,e)).state={currentLocation:{lat:45.51,lng:-122.68},zoom:13,userLocation:[],userLocationFound:!1,username:"",useremail:"",userID:"",stitch_res:[],pin:[],pins_line:[],pins_array:[]},a.getUserPosition=a.getUserPosition.bind(Object(s.a)(a)),a.drawpins=a.drawpins.bind(Object(s.a)(a)),a.drawlines=a.drawlines.bind(Object(s.a)(a)),a.openGoogle=a.openGoogle.bind(Object(s.a)(a));var o="capstonear_app-xkqng";a.client=x.d.hasAppClient(o)?x.d.getAppClient(o):x.d.initializeDefaultAppClient(o);var i=a.client.getServiceClient(x.c.factory,"mongodb-atlas");return a.db=i.db("APP"),a}return Object(c.a)(n,[{key:"getUserPosition",value:function(){var e=this;navigator.geolocation.getCurrentPosition((function(t){e.setState({userLocation:[t.coords.latitude,t.coords.longitude],userLocationFound:!0,currentLocation:[t.coords.latitude,t.coords.longitude]})}))}},{key:"componentDidMount",value:function(){this.getUserPosition(),this.drawpins()}},{key:"drawpins",value:function(){var e=Object(w.a)(y.a.mark((function e(){var t,n=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.client.auth.isLoggedIn){e.next=2;break}return e.abrupt("return");case 2:return t={_id:Object(O.ObjectId)(this.props.match.params.id)},e.next=5,this.db.collection("MODULES").findOne(t).then((function(e){n.setState({stitch_res:e}),console.log(n.state.stitch_res);var t=[{$match:{_id:{$in:e.pins}}},{$addFields:{__order:{$indexOfArray:[e.pins,"$_id"]}}},{$sort:{__order:1}}];n.db.collection("PINS").aggregate(t).toArray().then((function(e){console.log("Pins: ",e),n.setState({pins_array:e})}))}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"drawlines",value:function(){if(this.state.pins_line.length>0)return o.a.createElement(ue.a,{positions:this.state.pins_line,color:"red"})}},{key:"openGoogle",value:function(e){var t="http://maps.google.com?q="+e[0]+","+e[1];window.open(t,"_blank")}},{key:"render",value:function(){var e=this,t=this.state.userLocationFound?o.a.createElement(m.a,{position:this.state.userLocation,icon:de},o.a.createElement(p.a,null,"Your location")):null;return o.a.createElement("div",null,o.a.createElement(h.a,{center:this.state.currentLocation,zoom:13,maxZoom:18},o.a.createElement(f.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),t,this.state.pins_array.map((function(t,n){return o.a.createElement(m.a,{key:n,position:t.coords,icon:new b.a.divIcon({className:"my-div-icon",html:'<span style={Style} class="my-div-span">'+(n+1)+'</span><img class="my-div-image" src="https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png"/>'})},o.a.createElement(p.a,null,o.a.createElement("h1",null,t.desc),o.a.createElement("p",null,t.description),o.a.createElement("p",null,t.hint),o.a.createElement("p",null,t.destination),o.a.createElement("img",{style:{height:"100px",width:"150px"},src:"https://capstoneusercontent.s3-us-west-2.amazonaws.com/"+t._id.toString()+".jpeg"}),o.a.createElement("button",{onClick:function(){return e.openGoogle(t.coords)}},"Open Google Map")))}))))}}]),n}(a.Component),pe=n(321),he=n(32),fe=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;Object(l.a)(this,n),(a=t.call(this,e)).Home=function(){return a.client.auth.isLoggedIn?o.a.createElement("div",null,o.a.createElement(v,null)):o.a.createElement(D,null)},a.NavMenu=function(){if(a.client.auth.isLoggedIn)return o.a.createElement(U,{center_container:a.center_container})};var i="capstonear_app-xkqng";return a.client=x.d.hasAppClient(i)?x.d.getAppClient(i):x.d.initializeDefaultAppClient(i),a.client.auth.hasRedirectResult()&&(console.log("has results"),a.client.auth.handleRedirectResult().then((function(e){window.location.assign("/")}))),a.state={isLoggedIn:!1},a.center_container=o.a.createRef(),a.NavMenu=a.NavMenu.bind(Object(s.a)(a)),a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"handleStitchClient",value:function(){this.setState({stitchClient:this.client,userProfile:this.client.auth.userProfile,isLoggedIn:!0})}},{key:"render",value:function(){return o.a.createElement(pe.a,{basename:"/"},o.a.createElement("div",null,o.a.createElement(Y.a,{className:"navbar bg-dark navbar-dark",style:{position:"fixed",width:"100%",height:"50px",zIndex:1500}},o.a.createElement(Y.a.Brand,{href:"#/"},"Context AR")),this.NavMenu()),o.a.createElement("div",{ref:this.center_container,className:"center_container",style:{position:"fixed",top:"50px",bottom:"0",width:"100%",height:"calc(100% - 50px)"}},o.a.createElement(he.c,null,o.a.createElement(he.a,{exact:!0,path:"/menu",component:I}),o.a.createElement(he.a,{exact:!0,path:"/modules/edit",component:se}),o.a.createElement(he.a,{exact:!0,path:"/modules",component:Z}),o.a.createElement(he.a,{exact:!0,path:"/module/:id/pins/edit",component:A.a}),o.a.createElement(he.a,{exact:!0,path:"/module/:id/pins",component:me}),o.a.createElement(he.a,{exact:!0,path:"/module/:id/edit",component:W}),o.a.createElement(he.a,{path:"/module/:id",component:F}),o.a.createElement(he.a,{exact:!0,path:"/"},this.Home))))}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(fe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[324,1,2]]]);
//# sourceMappingURL=main.051086ff.chunk.js.map